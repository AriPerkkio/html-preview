import{S as O,i as U,s as I,e as p,k as v,t as W,c as u,a as T,m as A,h as Y,d as m,b as C,g as j,J as h,L as G,K as w,O as S}from"../chunks/vendor-f9d32276.js";function H(e,t){if(q(e,t))return B(e,t);const o=Array.from(t.childNodes).slice(e.childNodes.length),s=[];e.childNodes.forEach((n,l)=>{const i=t.childNodes[l];if(!i)return s.push(n);(n.hasChildNodes()||i.hasChildNodes())&&H(n,i),E(n)&&E(i)&&n.textContent!==i.textContent&&(n.textContent=i.textContent)});for(const n of s)e.removeChild(n);for(const n of o)e.appendChild(n);if(c(e)){const n=M(e),l=M(t),i=c(t);for(const{key:a,value:d}of l)e.getAttribute(a)!==d&&e.setAttribute(a,d);for(const{key:a}of n)i&&(t.hasAttribute(a)||e.removeAttribute(a))}}function c(e){return e!=null&&e.nodeType===Node.ELEMENT_NODE}function E(e){return e!=null&&e.nodeType===Node.TEXT_NODE}function M(e){return c(e)?e.getAttributeNames().reduce((t,o)=>[...t,{key:o,value:e.getAttribute(o)||""}],[]):[]}function q(e,t){return e.nodeType!==t.nodeType?!0:c(e)&&c(t)?e.tagName!==t.tagName:e.textContent!==t.textContent}function B(e,t){c(e)?e.replaceWith(t):E(e)&&E(t)?e.textContent=t.textContent:E(e)&&c(t)?e.parentElement?e.parentElement.replaceChild(t,e):console.warn(`Unexpected case, missing parentElement: ${e}`):console.warn(["Unexpected case:",`isElement(current): ${c(e)}`,`isTextNode(current): ${E(e)}`,`isElement(next): ${c(t)}`,`isTextNode(next): ${E(t)}`].join(" "))}function J(e){let t,o,s,n,l,i,a,d,r,f,y,g,L;return{c(){t=p("html"),o=p("head"),s=p("meta"),n=v(),l=p("title"),i=W("Sandbox"),a=v(),d=p("style"),r=v(),f=p("body"),y=p("div"),this.h()},l(_){t=u(_,"HTML",{lang:!0});var b=T(t);o=u(b,"HEAD",{});var N=T(o);s=u(N,"META",{charset:!0}),n=A(N),l=u(N,"TITLE",{});var k=T(l);i=Y(k,"Sandbox"),k.forEach(m),a=A(N),d=u(N,"STYLE",{});var D=T(d);D.forEach(m),N.forEach(m),r=A(b),f=u(b,"BODY",{class:!0});var x=T(f);y=u(x,"DIV",{}),T(y).forEach(m),x.forEach(m),b.forEach(m),this.h()},h(){C(s,"charset","utf-8"),C(f,"class","sandbox preview"),C(t,"lang","en")},m(_,b){j(_,t,b),h(t,o),h(o,s),h(o,n),h(o,l),h(l,i),h(o,a),h(o,d),e[2](d),h(t,r),h(t,f),h(f,y),e[3](y),g||(L=G(window,"message",e[1]),g=!0)},p:w,i:w,o:w,d(_){_&&m(t),e[2](null),e[3](null),g=!1,L()}}}function K(e,t,o){const s={};function n(a){const{type:d,value:r}=a.data;switch(d){case"CONTENT_CHANGE":if(s==null?void 0:s.root){const f=document.createElement("div");f.innerHTML=r,H(s.root,f)}break;case"STYLE_CHANGE":if(s==null?void 0:s.styles){const f=r.replace("<style>","").replace("</style>","");o(0,s.styles.innerHTML=f,s)}break;default:console.error("Unknown event caught",{type:d,value:r})}}function l(a){S[a?"unshift":"push"](()=>{s.styles=a,o(0,s)})}function i(a){S[a?"unshift":"push"](()=>{s.root=a,o(0,s)})}return[s,n,l,i]}class V extends O{constructor(t){super();U(this,t,K,J,I,{})}}export{V as default};
