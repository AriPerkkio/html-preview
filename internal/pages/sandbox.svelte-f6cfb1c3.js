import{S as O,i as I,s as Y,e as p,k as v,t as G,c as b,a as N,m as A,h as U,d as E,b as C,g as j,J as r,L as q,K as L,O as k}from"../chunks/vendor-b5f731c1.js";function w(t,e){if(B(t,e)){const s=T(e)?e.outerHTML:e.textContent;T(t)?t.outerHTML=s||"":t.textContent=s;return}const a=Array.from(e.childNodes).slice(t.childNodes.length),o=[];t.childNodes.forEach((s,l)=>{const i=e.childNodes[l];if(!i)return o.push(s);(s.hasChildNodes()||i.hasChildNodes())&&w(s,i),S(s)&&S(i)&&s.textContent!==i.textContent&&(s.textContent=i.textContent)});for(const s of o)t.removeChild(s);for(const s of a)t.appendChild(s);if(T(t)){const s=x(t),l=x(e),i=T(e);for(const{key:n,value:d}of l)t.getAttribute(n)!==d&&t.setAttribute(n,d);for(const{key:n}of s)i&&(e.hasAttribute(n)||t.removeAttribute(n))}}function T(t){return t!=null&&t.nodeType===Node.ELEMENT_NODE}function S(t){return t.nodeType===Node.TEXT_NODE}function x(t){return T(t)?t.getAttributeNames().reduce((e,a)=>[...e,{key:a,value:t.getAttribute(a)||""}],[]):[]}function B(t,e){return t.nodeType!==e.nodeType?!0:T(t)&&T(e)?t.tagName!==e.tagName:t.textContent!==e.textContent}function J(t){let e,a,o,s,l,i,n,d,u,c,f,h,g;return{c(){e=p("html"),a=p("head"),o=p("meta"),s=v(),l=p("title"),i=G("Sandbox"),n=v(),d=p("style"),u=v(),c=p("body"),f=p("div"),this.h()},l(_){e=b(_,"HTML",{lang:!0});var y=N(e);a=b(y,"HEAD",{});var m=N(a);o=b(m,"META",{charset:!0}),s=A(m),l=b(m,"TITLE",{});var H=N(l);i=U(H,"Sandbox"),H.forEach(E),n=A(m),d=b(m,"STYLE",{});var D=N(d);D.forEach(E),m.forEach(E),u=A(y),c=b(y,"BODY",{class:!0});var M=N(c);f=b(M,"DIV",{}),N(f).forEach(E),M.forEach(E),y.forEach(E),this.h()},h(){C(o,"charset","utf-8"),C(c,"class","sandbox preview"),C(e,"lang","en")},m(_,y){j(_,e,y),r(e,a),r(a,o),r(a,s),r(a,l),r(l,i),r(a,n),r(a,d),t[2](d),r(e,u),r(e,c),r(c,f),t[3](f),h||(g=q(window,"message",t[1]),h=!0)},p:L,i:L,o:L,d(_){_&&E(e),t[2](null),t[3](null),h=!1,g()}}}function K(t,e,a){const o={};function s(n){var c,f;const d=(c=n==null?void 0:n.data)==null?void 0:c.type,u=(f=n==null?void 0:n.data)==null?void 0:f.value;switch(d){case"CONTENT_CHANGE":if(o==null?void 0:o.root){const h=document.createElement("div");h.innerHTML=u,w(o.root,h)}break;case"STYLE_CHANGE":if(o==null?void 0:o.styles){const h=u.replace("<style>","").replace("</style>","");a(0,o.styles.innerHTML=h,o)}break;default:console.error("Unknown event caught",{type:d,value:u})}}function l(n){k[n?"unshift":"push"](()=>{o.styles=n,a(0,o)})}function i(n){k[n?"unshift":"push"](()=>{o.root=n,a(0,o)})}return[o,s,l,i]}class V extends O{constructor(e){super();I(this,e,K,J,Y,{})}}export{V as default};
