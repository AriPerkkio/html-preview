import{S as j,i as q,s as W,e as I,t as O,c as R,a as w,h as D,d as p,g as T,J as y,L as F,K as Z,k as C,m as S,b as U,M as te,v as oe,N as re,O as B,l as G,w as H,x as J,y as z,P as K,q as L,o as P,B as Q,n as fe,Q as _e,p as me,R as pe,T as X,U as he,V as ge,W as be}from"../chunks/vendor-94644b28.js";import{_ as ve,b as ne}from"../chunks/paths-fb6b994c.js";function ie(i){let e,t,r,s;return{c(){e=I("button"),t=O("Remove editor")},l(o){e=R(o,"BUTTON",{});var n=w(e);t=D(n,"Remove editor"),n.forEach(p)},m(o,n){T(o,e,n),y(e,t),r||(s=F(e,"click",i[4]),r=!0)},p:Z,d(o){o&&p(e),r=!1,s()}}}function ye(i){let e,t,r,s=i[2]&&ie(i);return{c(){s&&s.c(),e=C(),t=I("div"),r=I("textarea"),this.h()},l(o){s&&s.l(o),e=S(o),t=R(o,"DIV",{class:!0});var n=w(t);r=R(n,"TEXTAREA",{class:!0}),w(r).forEach(p),n.forEach(p),this.h()},h(){r.value=i[0],U(r,"class","svelte-1awo5ji"),U(t,"class","codemirror-container svelte-1awo5ji"),te(t,"active",i[1])},m(o,n){s&&s.m(o,n),T(o,e,n),T(o,t,n),y(t,r),i[6](r)},p(o,[n]){o[2]?s?s.p(o,n):(s=ie(o),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),n&1&&(r.value=o[0]),n&2&&te(t,"active",o[1])},i:Z,o:Z,d(o){s&&s.d(o),o&&p(e),o&&p(t),i[6](null)}}}function Ee(i,e,t){let{code:r=""}=e,{editorId:s}=e,{active:o=!1}=e,{canBeRemoved:n=!0}=e,l;oe(async()=>{if(!l)throw new Error("Missing ref to textarea");const{default:f}=await ve(()=>import("../chunks/codemirror-f605f246.js"),["chunks/codemirror-f605f246.js","assets/codemirror-6f45da0e.css"]);f.fromTextArea(l,{lineNumbers:!0,lineWrapping:!0,mode:"htmlmixed",autoCloseBrackets:!0,autoCloseTags:!0,value:r}).on("change",a=>{t(0,r=a.getValue()),u("change",{value:r,editorId:s})})});const u=re();function m(){u("remove",{editorId:s})}function h(f){B[f?"unshift":"push"](()=>{l=f,t(3,l)})}return i.$$set=f=>{"code"in f&&t(0,r=f.code),"editorId"in f&&t(5,s=f.editorId),"active"in f&&t(1,o=f.active),"canBeRemoved"in f&&t(2,n=f.canBeRemoved)},i.$$.update=()=>{i.$$.dirty&35&&o&&u("change",{value:r,editorId:s})},[r,o,n,l,m,s,h]}class se extends j{constructor(e){super();q(this,e,Ee,ye,W,{code:0,editorId:5,active:1,canBeRemoved:2})}}function de(i,e,t){const r=i.slice();return r[9]=e[t],r[10]=e,r[11]=t,r}function ae(i,e){let t,r,s,o;function n(u){e[6](u,e[9])}let l={canBeRemoved:e[9].id!==V,active:e[9].id===e[1],editorId:e[9].id};return e[9].code!==void 0&&(l.code=e[9].code),r=new se({props:l}),B.push(()=>X(r,"code",n)),r.$on("change",e[5]),r.$on("remove",e[3]),{key:i,first:null,c(){t=G(),H(r.$$.fragment),this.h()},l(u){t=G(),J(r.$$.fragment,u),this.h()},h(){this.first=t},m(u,m){T(u,t,m),z(r,u,m),o=!0},p(u,m){e=u;const h={};m&1&&(h.canBeRemoved=e[9].id!==V),m&3&&(h.active=e[9].id===e[1]),m&1&&(h.editorId=e[9].id),!s&&m&1&&(s=!0,h.code=e[9].code,K(()=>s=!1)),r.$set(h)},i(u){o||(L(r.$$.fragment,u),o=!0)},o(u){P(r.$$.fragment,u),o=!1},d(u){u&&p(t),Q(r,u)}}}function ke(i){let e,t,r,s,o,n,l=[],u=new Map,m,h,f,E,a=i[0];const _=d=>d[9].id;for(let d=0;d<a.length;d+=1){let c=de(i,a,d),b=_(c);u.set(b,l[d]=ae(b,c))}return{c(){e=I("button"),t=O("Next state"),r=C(),s=I("button"),o=O("Add editor"),n=C();for(let d=0;d<l.length;d+=1)l[d].c();m=G()},l(d){e=R(d,"BUTTON",{});var c=w(e);t=D(c,"Next state"),c.forEach(p),r=S(d),s=R(d,"BUTTON",{});var b=w(s);o=D(b,"Add editor"),b.forEach(p),n=S(d);for(let A=0;A<l.length;A+=1)l[A].l(d);m=G()},m(d,c){T(d,e,c),y(e,t),T(d,r,c),T(d,s,c),y(s,o),T(d,n,c);for(let b=0;b<l.length;b+=1)l[b].m(d,c);T(d,m,c),h=!0,f||(E=[F(e,"click",i[4]),F(s,"click",i[2])],f=!0)},p(d,[c]){c&43&&(a=d[0],fe(),l=_e(l,c,_,1,d,a,u,m.parentNode,he,ae,m,de),me())},i(d){if(!h){for(let c=0;c<a.length;c+=1)L(l[c]);h=!0}},o(d){for(let c=0;c<l.length;c+=1)P(l[c]);h=!1},d(d){d&&p(e),d&&p(r),d&&p(s),d&&p(n);for(let c=0;c<l.length;c+=1)l[c].d(d);d&&p(m),f=!1,pe(E)}}}const V=1;function Te(i,e,t){var E;let r;const s=re();let{editors:o=[{id:V,code:""}]}=e,n=((E=o[0])==null?void 0:E.id)||V;function l(){var _;const a=((_=o.find(d=>d.id===r))==null?void 0:_.code)||"";t(0,o=[...o,{id:1+r,code:a}])}function u(a){const{editorId:_}=a.detail;if(n===_){const d=o.findIndex(b=>b.id===_),c=o[d-1];t(1,n=(c==null?void 0:c.id)||V)}t(0,o=o.filter(d=>d.id!==_))}function m(){const a=o.map(d=>d.id);if(n===r){t(1,n=Math.min(...a));return}const _=a.indexOf(n);t(1,n=a[1+_])}function h(a){const{value:_,editorId:d}=a.detail;d===n&&s("change",{value:_})}function f(a,_){i.$$.not_equal(_.code,a)&&(_.code=a,t(0,o))}return i.$$set=a=>{"editors"in a&&t(0,o=a.editors)},i.$$.update=()=>{i.$$.dirty&1&&(r=Math.max(...o.map(a=>a.id)))},[o,n,l,u,m,h,f]}class Ie extends j{constructor(e){super();q(this,e,Te,ke,W,{editors:0})}}function Re(i){let e,t,r;function s(n){i[1](n)}let o={editorId:0,canBeRemoved:!1};return i[0]!==void 0&&(o.code=i[0]),e=new se({props:o}),B.push(()=>X(e,"code",s)),e.$on("change",i[2]),{c(){H(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,l){z(e,n,l),r=!0},p(n,[l]){const u={};!t&&l&1&&(t=!0,u.code=n[0],K(()=>t=!1)),e.$set(u)},i(n){r||(L(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){Q(e,n)}}}function we(i,e,t){let{code:r=""}=e;function s(n){r=n,t(0,r)}function o(n){ge.call(this,i,n)}return i.$$set=n=>{"code"in n&&t(0,r=n.code)},[r,s,o]}class Ne extends j{constructor(e){super();q(this,e,we,Re,W,{code:0})}}function Ue(){const i={editors:[{id:1,code:""}],style:`<style>
  
</style>`},e=new URLSearchParams(document.location.search).get("code");let t;if(e)try{const r=atob(decodeURIComponent(e));t=JSON.parse(r)}catch(r){console.error("Unable to parse url search parameters",r)}return Y(t,"style")&&typeof t.style=="string"&&Y(t,"editors")&&Array.isArray(t.editors)&&t.editors.every(Se)?{style:t.style,editors:t.editors}:i}function Ce(i){const e=btoa(JSON.stringify(i)),t=new URL(ne,window.location.origin);return t.searchParams.set("code",encodeURIComponent(e)),t}function Se(i){return Y(i,"id")&&typeof i.id=="number"&&Y(i,"code")&&typeof i.code=="string"}function Y(i,e){return i?e in i:!1}function ce(i){let e;return{c(){e=O("URL copied to clipboard!")},l(t){e=D(t,"URL copied to clipboard!")},m(t,r){T(t,e,r)},d(t){t&&p(e)}}}function Ae(i){let e,t,r,s,o,n,l,u,m,h,f,E,a,_,d,c,b,A,v=i[2]&&ce();function le(g){i[7](g)}let $={};i[0]!==void 0&&($.code=i[0]),f=new Ne({props:$}),B.push(()=>X(f,"code",le));function ue(g){i[8](g)}let x={};return i[3]!==void 0&&(x.editors=i[3]),_=new Ie({props:x}),B.push(()=>X(_,"editors",ue)),_.$on("change",i[4]),{c(){e=I("div"),t=I("iframe"),s=C(),o=I("div"),n=I("button"),l=O("Export"),u=C(),m=I("span"),v&&v.c(),h=C(),H(f.$$.fragment),a=C(),H(_.$$.fragment),this.h()},l(g){e=R(g,"DIV",{class:!0});var N=w(e);t=R(N,"IFRAME",{security:!0,src:!0,title:!0}),w(t).forEach(p),s=S(N),o=R(N,"DIV",{});var k=w(o);n=R(k,"BUTTON",{class:!0});var M=w(n);l=D(M,"Export"),M.forEach(p),u=S(k),m=R(k,"SPAN",{"aria-live":!0});var ee=w(m);v&&v.l(ee),ee.forEach(p),h=S(k),J(f.$$.fragment,k),a=S(k),J(_.$$.fragment,k),k.forEach(p),N.forEach(p),this.h()},h(){U(t,"security","restricted"),be(t.src,r=""+(ne+"/sandbox"))||U(t,"src",r),U(t,"title","Sandbox"),U(n,"class","export-btn svelte-1d5ock9"),U(m,"aria-live","polite"),U(e,"class","wrapper svelte-1d5ock9")},m(g,N){T(g,e,N),y(e,t),i[6](t),y(e,s),y(e,o),y(o,n),y(n,l),y(o,u),y(o,m),v&&v.m(m,null),y(o,h),z(f,o,null),y(o,a),z(_,o,null),c=!0,b||(A=F(n,"click",i[5]),b=!0)},p(g,[N]){g[2]?v||(v=ce(),v.c(),v.m(m,null)):v&&(v.d(1),v=null);const k={};!E&&N&1&&(E=!0,k.code=g[0],K(()=>E=!1)),f.$set(k);const M={};!d&&N&8&&(d=!0,M.editors=g[3],K(()=>d=!1)),_.$set(M)},i(g){c||(L(f.$$.fragment,g),L(_.$$.fragment,g),c=!0)},o(g){P(f.$$.fragment,g),P(_.$$.fragment,g),c=!1},d(g){g&&p(e),i[6](null),v&&v.d(),Q(f),Q(_),b=!1,A()}}}function Be(i,e,t){const r={};let s,{editors:o,style:n}=Ue();oe(()=>{l({type:"CONTENT_CHANGE",value:o[0].code})});function l(a,_=5){var c;const d=(c=r.sandbox)==null?void 0:c.contentWindow;d?d.postMessage(a):_>0&&setTimeout(()=>l(a,_-1),500)}function u(a){l({type:"CONTENT_CHANGE",value:a.detail.value})}function m(){const a=Ce({style:n,editors:o});window.history.pushState({},"",a),t(2,s=a.toString()),navigator.clipboard.writeText(s).then(()=>{setTimeout(()=>{t(2,s="")},3e3)})}function h(a){B[a?"unshift":"push"](()=>{r.sandbox=a,t(1,r)})}function f(a){n=a,t(0,n)}function E(a){o=a,t(3,o)}return i.$$.update=()=>{i.$$.dirty&1&&l({type:"STYLE_CHANGE",value:n})},[n,r,s,o,u,m,h,f,E]}class De extends j{constructor(e){super();q(this,e,Be,Ae,W,{})}}export{De as default};
