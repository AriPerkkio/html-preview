import{S as D,i as L,s as q,e as I,t as O,c as T,a as N,h as P,d as h,g as w,J as E,L as W,K as Y,k as S,m as U,b as C,M as ee,N as te,v as le,O as M,l as J,w as F,x as G,y as H,P as z,q as V,o as j,B as K,n as ue,Q as fe,p as _e,R as me,T as Q,U as he,V as pe,W as ge}from"../chunks/vendor-f9d32276.js";import{_ as be,b as oe}from"../chunks/paths-fb6b994c.js";function re(n){let e,t,i,s;return{c(){e=I("button"),t=O("Remove editor")},l(o){e=T(o,"BUTTON",{});var r=N(e);t=P(r,"Remove editor"),r.forEach(h)},m(o,r){w(o,e,r),E(e,t),i||(s=W(e,"click",n[3]),i=!0)},p:Y,d(o){o&&h(e),i=!1,s()}}}function ve(n){let e,t,i,s=!n[0]&&n[1]&&re(n);return{c(){s&&s.c(),e=S(),t=I("div"),i=I("textarea"),this.h()},l(o){s&&s.l(o),e=U(o),t=T(o,"DIV",{class:!0});var r=N(t);i=T(r,"TEXTAREA",{class:!0}),N(i).forEach(h),r.forEach(h),this.h()},h(){C(i,"class","svelte-1awo5ji"),C(t,"class","codemirror-container svelte-1awo5ji"),ee(t,"active",n[0])},m(o,r){s&&s.m(o,r),w(o,e,r),w(o,t,r),E(t,i),n[6](i)},p(o,[r]){!o[0]&&o[1]?s?s.p(o,r):(s=re(o),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),r&1&&ee(t,"active",o[0])},i:Y,o:Y,d(o){s&&s.d(o),o&&h(e),o&&h(t),n[6](null)}}}function ye(n,e,t){const i=te();let{code:s=""}=e,{editorId:o}=e,{active:r=!1}=e,{canBeRemoved:u=!0}=e,c;le(async()=>{let d=await be(()=>import("../chunks/codemirror-f605f246.js"),["chunks/codemirror-f605f246.js","assets/codemirror-6f45da0e.css"]);await m(d.default)});async function m(d){if(!c)throw new Error("Missing ref to textarea");const l=d.fromTextArea(c,{lineNumbers:!0,lineWrapping:!0,mode:"htmlmixed",autoCloseBrackets:!0,autoCloseTags:!0,value:s});l.on("change",_=>{t(4,s=_.getValue()),i("change",{value:s,editorId:o})}),l.setValue(s)}function p(){i("remove",{editorId:o})}function g(d){M[d?"unshift":"push"](()=>{c=d,t(2,c)})}return n.$$set=d=>{"code"in d&&t(4,s=d.code),"editorId"in d&&t(5,o=d.editorId),"active"in d&&t(0,r=d.active),"canBeRemoved"in d&&t(1,u=d.canBeRemoved)},n.$$.update=()=>{n.$$.dirty&49&&r&&i("change",{value:s,editorId:o})},[r,u,c,p,s,o,g]}class ne extends D{constructor(e){super();L(this,e,ye,ve,q,{code:4,editorId:5,active:0,canBeRemoved:1})}}function ie(n,e,t){const i=n.slice();return i[9]=e[t],i[10]=e,i[11]=t,i}function se(n,e){let t,i,s,o;function r(c){e[6](c,e[9])}let u={active:e[9].id===e[1],editorId:e[9].id};return e[9].code!==void 0&&(u.code=e[9].code),i=new ne({props:u}),M.push(()=>Q(i,"code",r)),i.$on("change",e[5]),i.$on("remove",e[3]),{key:n,first:null,c(){t=J(),F(i.$$.fragment),this.h()},l(c){t=J(),G(i.$$.fragment,c),this.h()},h(){this.first=t},m(c,m){w(c,t,m),H(i,c,m),o=!0},p(c,m){e=c;const p={};m&3&&(p.active=e[9].id===e[1]),m&1&&(p.editorId=e[9].id),!s&&m&1&&(s=!0,p.code=e[9].code,z(()=>s=!1)),i.$set(p)},i(c){o||(V(i.$$.fragment,c),o=!0)},o(c){j(i.$$.fragment,c),o=!1},d(c){c&&h(t),K(i,c)}}}function Ee(n){let e,t,i,s,o,r,u=[],c=new Map,m,p,g,d,l=n[0];const _=a=>a[9].id;for(let a=0;a<l.length;a+=1){let f=ie(n,l,a),y=_(f);c.set(y,u[a]=se(y,f))}return{c(){e=I("button"),t=O("Next state"),i=S(),s=I("button"),o=O("Add editor"),r=S();for(let a=0;a<u.length;a+=1)u[a].c();m=J()},l(a){e=T(a,"BUTTON",{});var f=N(e);t=P(f,"Next state"),f.forEach(h),i=U(a),s=T(a,"BUTTON",{});var y=N(s);o=P(y,"Add editor"),y.forEach(h),r=U(a);for(let A=0;A<u.length;A+=1)u[A].l(a);m=J()},m(a,f){w(a,e,f),E(e,t),w(a,i,f),w(a,s,f),E(s,o),w(a,r,f);for(let y=0;y<u.length;y+=1)u[y].m(a,f);w(a,m,f),p=!0,g||(d=[W(e,"click",n[4]),W(s,"click",n[2])],g=!0)},p(a,[f]){f&43&&(l=a[0],ue(),u=fe(u,f,_,1,a,l,c,m.parentNode,he,se,m,ie),_e())},i(a){if(!p){for(let f=0;f<l.length;f+=1)V(u[f]);p=!0}},o(a){for(let f=0;f<u.length;f+=1)j(u[f]);p=!1},d(a){a&&h(e),a&&h(i),a&&h(s),a&&h(r);for(let f=0;f<u.length;f+=1)u[f].d(a);a&&h(m),g=!1,me(d)}}}function ke(n,e,t){var d;let i;const s=te();let{editors:o=[{id:1,code:""}]}=e,r=((d=o[0])==null?void 0:d.id)||1;function u(){var _;const l=((_=o.find(a=>a.id===i))==null?void 0:_.code)||"";t(0,o=[...o,{id:1+i,code:l}])}function c(l){const{editorId:_}=l.detail;t(0,o=o.filter(a=>a.id!==_))}function m(){const l=o.map(a=>a.id);if(r===i){t(1,r=Math.min(...l));return}const _=l.indexOf(r);t(1,r=l[1+_])}function p(l){const{value:_,editorId:a}=l.detail;a===r&&s("change",{value:_})}function g(l,_){n.$$.not_equal(_.code,l)&&(_.code=l,t(0,o))}return n.$$set=l=>{"editors"in l&&t(0,o=l.editors)},n.$$.update=()=>{n.$$.dirty&1&&(i=Math.max(...o.map(l=>l.id)))},[o,r,u,c,m,p,g]}class we extends D{constructor(e){super();L(this,e,ke,Ee,q,{editors:0})}}function Ie(n){let e,t,i;function s(r){n[1](r)}let o={editorId:0,canBeRemoved:!1};return n[0]!==void 0&&(o.code=n[0]),e=new ne({props:o}),M.push(()=>Q(e,"code",s)),e.$on("change",n[2]),{c(){F(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,u){H(e,r,u),i=!0},p(r,[u]){const c={};!t&&u&1&&(t=!0,c.code=r[0],z(()=>t=!1)),e.$set(c)},i(r){i||(V(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){K(e,r)}}}function Te(n,e,t){let{code:i=""}=e;function s(r){i=r,t(0,i)}function o(r){pe.call(this,n,r)}return n.$$set=r=>{"code"in r&&t(0,i=r.code)},[i,s,o]}class Ne extends D{constructor(e){super();L(this,e,Te,Ie,q,{code:0})}}function Re(){const n={editors:[{id:1,code:""}],style:`<style>
  
</style>`},e=new URLSearchParams(document.location.search).get("code");let t;if(e)try{const i=atob(decodeURIComponent(e));t=JSON.parse(i)}catch(i){console.error("Unable to parse url search parameters",i)}return X(t,"style")&&typeof t.style=="string"&&X(t,"editors")&&Array.isArray(t.editors)&&t.editors.every(Se)?{style:t.style,editors:t.editors}:n}function Ce(n){const e=btoa(JSON.stringify(n)),t=new URL(oe,window.location.origin);return t.searchParams.set("code",encodeURIComponent(e)),t}function Se(n){return X(n,"id")&&typeof n.id=="number"&&X(n,"code")&&typeof n.code=="string"}function X(n,e){return n?e in n:!1}function ae(n){let e;return{c(){e=O("Copied to clipboard!")},l(t){e=P(t,"Copied to clipboard!")},m(t,i){w(t,e,i)},d(t){t&&h(e)}}}function Ue(n){let e,t,i,s,o,r,u,c,m,p,g,d,l,_,a,f,y,A,v=n[2]&&ae();function de(b){n[7](b)}let Z={};n[1]!==void 0&&(Z.code=n[1]),g=new Ne({props:Z}),M.push(()=>Q(g,"code",de));function ce(b){n[8](b)}let $={};return n[3]!==void 0&&($.editors=n[3]),_=new we({props:$}),M.push(()=>Q(_,"editors",ce)),_.$on("change",n[4]),{c(){e=I("div"),t=I("iframe"),s=S(),o=I("div"),r=I("button"),u=O("Export"),c=S(),m=I("span"),v&&v.c(),p=S(),F(g.$$.fragment),l=S(),F(_.$$.fragment),this.h()},l(b){e=T(b,"DIV",{class:!0});var R=N(e);t=T(R,"IFRAME",{security:!0,src:!0,title:!0}),N(t).forEach(h),s=U(R),o=T(R,"DIV",{});var k=N(o);r=T(k,"BUTTON",{class:!0});var B=N(r);u=P(B,"Export"),B.forEach(h),c=U(k),m=T(k,"SPAN",{"aria-live":!0});var x=N(m);v&&v.l(x),x.forEach(h),p=U(k),G(g.$$.fragment,k),l=U(k),G(_.$$.fragment,k),k.forEach(h),R.forEach(h),this.h()},h(){C(t,"security","restricted"),ge(t.src,i=""+(oe+"/sandbox"))||C(t,"src",i),C(t,"title","Sandbox"),C(r,"class","export-btn svelte-1d5ock9"),C(m,"aria-live","polite"),C(e,"class","wrapper svelte-1d5ock9")},m(b,R){w(b,e,R),E(e,t),n[6](t),E(e,s),E(e,o),E(o,r),E(r,u),E(o,c),E(o,m),v&&v.m(m,null),E(o,p),H(g,o,null),E(o,l),H(_,o,null),f=!0,y||(A=W(r,"click",n[5]),y=!0)},p(b,[R]){b[2]?v||(v=ae(),v.c(),v.m(m,null)):v&&(v.d(1),v=null);const k={};!d&&R&2&&(d=!0,k.code=b[1],z(()=>d=!1)),g.$set(k);const B={};!a&&R&8&&(a=!0,B.editors=b[3],z(()=>a=!1)),_.$set(B)},i(b){f||(V(g.$$.fragment,b),V(_.$$.fragment,b),f=!0)},o(b){j(g.$$.fragment,b),j(_.$$.fragment,b),f=!1},d(b){b&&h(e),n[6](null),v&&v.d(),K(g),K(_),y=!1,A()}}}function Ae(n,e,t){const i={};let s,{editors:o,style:r}=Re();function u(d){var _,a;const{value:l}=d.detail;(a=(_=i.sandbox)==null?void 0:_.contentWindow)==null||a.postMessage({type:"CONTENT_CHANGE",value:l})}function c(){const d=Ce({style:r,editors:o});window.history.pushState({},"",d),t(2,s=d.toString()),navigator.clipboard.writeText(s).then(()=>{setTimeout(()=>{t(2,s="")},3e3)})}function m(d){M[d?"unshift":"push"](()=>{i.sandbox=d,t(0,i)})}function p(d){r=d,t(1,r)}function g(d){o=d,t(3,o)}return n.$$.update=()=>{var d,l;n.$$.dirty&3&&((l=(d=i.sandbox)==null?void 0:d.contentWindow)==null||l.postMessage({type:"STYLE_CHANGE",value:r}))},[i,r,s,o,u,c,m,p,g]}class Oe extends D{constructor(e){super();L(this,e,Ae,Ue,q,{})}}export{Oe as default};
