import{S as j,i as q,s as W,e as T,t as O,c as w,a as R,h as D,d as h,g as I,J as E,L as F,K as Z,k as C,m as U,b as S,M as te,N as oe,v as ue,O as B,l as J,w as G,x as H,y as z,P as K,q as P,o as V,B as Q,n as fe,Q as _e,p as me,R as he,T as X,U as pe,V as ge,W as be}from"../chunks/vendor-94644b28.js";import{_ as ve,b as ne}from"../chunks/paths-fb6b994c.js";function re(r){let e,t,i,s;return{c(){e=T("button"),t=O("Remove editor")},l(o){e=w(o,"BUTTON",{});var n=R(e);t=D(n,"Remove editor"),n.forEach(h)},m(o,n){I(o,e,n),E(e,t),i||(s=F(e,"click",r[3]),i=!0)},p:Z,d(o){o&&h(e),i=!1,s()}}}function ye(r){let e,t,i,s=r[1]&&re(r);return{c(){s&&s.c(),e=C(),t=T("div"),i=T("textarea"),this.h()},l(o){s&&s.l(o),e=U(o),t=w(o,"DIV",{class:!0});var n=R(t);i=w(n,"TEXTAREA",{class:!0}),R(i).forEach(h),n.forEach(h),this.h()},h(){S(i,"class","svelte-1awo5ji"),S(t,"class","codemirror-container svelte-1awo5ji"),te(t,"active",r[0])},m(o,n){s&&s.m(o,n),I(o,e,n),I(o,t,n),E(t,i),r[6](i)},p(o,[n]){o[1]?s?s.p(o,n):(s=re(o),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),n&1&&te(t,"active",o[0])},i:Z,o:Z,d(o){s&&s.d(o),o&&h(e),o&&h(t),r[6](null)}}}function Ee(r,e,t){const i=oe();let{code:s=""}=e,{editorId:o}=e,{active:n=!1}=e,{canBeRemoved:u=!0}=e,l;ue(async()=>{let m=await ve(()=>import("../chunks/codemirror-f605f246.js"),["chunks/codemirror-f605f246.js","assets/codemirror-6f45da0e.css"]);await _(m.default)});async function _(m){if(!l)throw new Error("Missing ref to textarea");const a=m.fromTextArea(l,{lineNumbers:!0,lineWrapping:!0,mode:"htmlmixed",autoCloseBrackets:!0,autoCloseTags:!0,value:s});a.on("change",f=>{t(4,s=f.getValue()),i("change",{value:s,editorId:o})}),a.setValue(s)}function p(){i("remove",{editorId:o})}function g(m){B[m?"unshift":"push"](()=>{l=m,t(2,l)})}return r.$$set=m=>{"code"in m&&t(4,s=m.code),"editorId"in m&&t(5,o=m.editorId),"active"in m&&t(0,n=m.active),"canBeRemoved"in m&&t(1,u=m.canBeRemoved)},r.$$.update=()=>{r.$$.dirty&49&&n&&i("change",{value:s,editorId:o})},[n,u,l,p,s,o,g]}class ie extends j{constructor(e){super();q(this,e,Ee,ye,W,{code:4,editorId:5,active:0,canBeRemoved:1})}}function se(r,e,t){const i=r.slice();return i[9]=e[t],i[10]=e,i[11]=t,i}function de(r,e){let t,i,s,o;function n(l){e[6](l,e[9])}let u={canBeRemoved:e[9].id!==L,active:e[9].id===e[1],editorId:e[9].id};return e[9].code!==void 0&&(u.code=e[9].code),i=new ie({props:u}),B.push(()=>X(i,"code",n)),i.$on("change",e[5]),i.$on("remove",e[3]),{key:r,first:null,c(){t=J(),G(i.$$.fragment),this.h()},l(l){t=J(),H(i.$$.fragment,l),this.h()},h(){this.first=t},m(l,_){I(l,t,_),z(i,l,_),o=!0},p(l,_){e=l;const p={};_&1&&(p.canBeRemoved=e[9].id!==L),_&3&&(p.active=e[9].id===e[1]),_&1&&(p.editorId=e[9].id),!s&&_&1&&(s=!0,p.code=e[9].code,K(()=>s=!1)),i.$set(p)},i(l){o||(P(i.$$.fragment,l),o=!0)},o(l){V(i.$$.fragment,l),o=!1},d(l){l&&h(t),Q(i,l)}}}function ke(r){let e,t,i,s,o,n,u=[],l=new Map,_,p,g,m,a=r[0];const f=d=>d[9].id;for(let d=0;d<a.length;d+=1){let c=se(r,a,d),v=f(c);l.set(v,u[d]=de(v,c))}return{c(){e=T("button"),t=O("Next state"),i=C(),s=T("button"),o=O("Add editor"),n=C();for(let d=0;d<u.length;d+=1)u[d].c();_=J()},l(d){e=w(d,"BUTTON",{});var c=R(e);t=D(c,"Next state"),c.forEach(h),i=U(d),s=w(d,"BUTTON",{});var v=R(s);o=D(v,"Add editor"),v.forEach(h),n=U(d);for(let A=0;A<u.length;A+=1)u[A].l(d);_=J()},m(d,c){I(d,e,c),E(e,t),I(d,i,c),I(d,s,c),E(s,o),I(d,n,c);for(let v=0;v<u.length;v+=1)u[v].m(d,c);I(d,_,c),p=!0,g||(m=[F(e,"click",r[4]),F(s,"click",r[2])],g=!0)},p(d,[c]){c&43&&(a=d[0],fe(),u=_e(u,c,f,1,d,a,l,_.parentNode,pe,de,_,se),me())},i(d){if(!p){for(let c=0;c<a.length;c+=1)P(u[c]);p=!0}},o(d){for(let c=0;c<u.length;c+=1)V(u[c]);p=!1},d(d){d&&h(e),d&&h(i),d&&h(s),d&&h(n);for(let c=0;c<u.length;c+=1)u[c].d(d);d&&h(_),g=!1,he(m)}}}const L=1;function Ie(r,e,t){var m;let i;const s=oe();let{editors:o=[{id:L,code:""}]}=e,n=((m=o[0])==null?void 0:m.id)||L;function u(){var f;const a=((f=o.find(d=>d.id===i))==null?void 0:f.code)||"";t(0,o=[...o,{id:1+i,code:a}])}function l(a){const{editorId:f}=a.detail;if(n===f){const d=o.findIndex(v=>v.id===f),c=o[d-1];t(1,n=(c==null?void 0:c.id)||L)}t(0,o=o.filter(d=>d.id!==f))}function _(){const a=o.map(d=>d.id);if(n===i){t(1,n=Math.min(...a));return}const f=a.indexOf(n);t(1,n=a[1+f])}function p(a){const{value:f,editorId:d}=a.detail;d===n&&s("change",{value:f})}function g(a,f){r.$$.not_equal(f.code,a)&&(f.code=a,t(0,o))}return r.$$set=a=>{"editors"in a&&t(0,o=a.editors)},r.$$.update=()=>{r.$$.dirty&1&&(i=Math.max(...o.map(a=>a.id)))},[o,n,u,l,_,p,g]}class Te extends j{constructor(e){super();q(this,e,Ie,ke,W,{editors:0})}}function we(r){let e,t,i;function s(n){r[1](n)}let o={editorId:0,canBeRemoved:!1};return r[0]!==void 0&&(o.code=r[0]),e=new ie({props:o}),B.push(()=>X(e,"code",s)),e.$on("change",r[2]),{c(){G(e.$$.fragment)},l(n){H(e.$$.fragment,n)},m(n,u){z(e,n,u),i=!0},p(n,[u]){const l={};!t&&u&1&&(t=!0,l.code=n[0],K(()=>t=!1)),e.$set(l)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){V(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Re(r,e,t){let{code:i=""}=e;function s(n){i=n,t(0,i)}function o(n){ge.call(this,r,n)}return r.$$set=n=>{"code"in n&&t(0,i=n.code)},[i,s,o]}class Ne extends j{constructor(e){super();q(this,e,Re,we,W,{code:0})}}function Se(){const r={editors:[{id:1,code:""}],style:`<style>
  
</style>`},e=new URLSearchParams(document.location.search).get("code");let t;if(e)try{const i=atob(decodeURIComponent(e));t=JSON.parse(i)}catch(i){console.error("Unable to parse url search parameters",i)}return Y(t,"style")&&typeof t.style=="string"&&Y(t,"editors")&&Array.isArray(t.editors)&&t.editors.every(Ue)?{style:t.style,editors:t.editors}:r}function Ce(r){const e=btoa(JSON.stringify(r)),t=new URL(ne,window.location.origin);return t.searchParams.set("code",encodeURIComponent(e)),t}function Ue(r){return Y(r,"id")&&typeof r.id=="number"&&Y(r,"code")&&typeof r.code=="string"}function Y(r,e){return r?e in r:!1}function ae(r){let e;return{c(){e=O("Copied to clipboard!")},l(t){e=D(t,"Copied to clipboard!")},m(t,i){I(t,e,i)},d(t){t&&h(e)}}}function Ae(r){let e,t,i,s,o,n,u,l,_,p,g,m,a,f,d,c,v,A,y=r[2]&&ae();function ce(b){r[7](b)}let x={};r[0]!==void 0&&(x.code=r[0]),g=new Ne({props:x}),B.push(()=>X(g,"code",ce));function le(b){r[8](b)}let $={};return r[3]!==void 0&&($.editors=r[3]),f=new Te({props:$}),B.push(()=>X(f,"editors",le)),f.$on("change",r[4]),{c(){e=T("div"),t=T("iframe"),s=C(),o=T("div"),n=T("button"),u=O("Export"),l=C(),_=T("span"),y&&y.c(),p=C(),G(g.$$.fragment),a=C(),G(f.$$.fragment),this.h()},l(b){e=w(b,"DIV",{class:!0});var N=R(e);t=w(N,"IFRAME",{security:!0,src:!0,title:!0}),R(t).forEach(h),s=U(N),o=w(N,"DIV",{});var k=R(o);n=w(k,"BUTTON",{class:!0});var M=R(n);u=D(M,"Export"),M.forEach(h),l=U(k),_=w(k,"SPAN",{"aria-live":!0});var ee=R(_);y&&y.l(ee),ee.forEach(h),p=U(k),H(g.$$.fragment,k),a=U(k),H(f.$$.fragment,k),k.forEach(h),N.forEach(h),this.h()},h(){S(t,"security","restricted"),be(t.src,i=""+(ne+"/sandbox"))||S(t,"src",i),S(t,"title","Sandbox"),S(n,"class","export-btn svelte-1d5ock9"),S(_,"aria-live","polite"),S(e,"class","wrapper svelte-1d5ock9")},m(b,N){I(b,e,N),E(e,t),r[6](t),E(e,s),E(e,o),E(o,n),E(n,u),E(o,l),E(o,_),y&&y.m(_,null),E(o,p),z(g,o,null),E(o,a),z(f,o,null),c=!0,v||(A=F(n,"click",r[5]),v=!0)},p(b,[N]){b[2]?y||(y=ae(),y.c(),y.m(_,null)):y&&(y.d(1),y=null);const k={};!m&&N&1&&(m=!0,k.code=b[0],K(()=>m=!1)),g.$set(k);const M={};!d&&N&8&&(d=!0,M.editors=b[3],K(()=>d=!1)),f.$set(M)},i(b){c||(P(g.$$.fragment,b),P(f.$$.fragment,b),c=!0)},o(b){V(g.$$.fragment,b),V(f.$$.fragment,b),c=!1},d(b){b&&h(e),r[6](null),y&&y.d(),Q(g),Q(f),v=!1,A()}}}function Be(r,e,t){const i={};let s,{editors:o,style:n}=Se();function u(a,f=5){var c;const d=(c=i.sandbox)==null?void 0:c.contentWindow;d?d.postMessage(a):f>0&&setTimeout(()=>u(a,f-1),500)}function l(a){u({type:"CONTENT_CHANGE",value:a.detail.value})}function _(){const a=Ce({style:n,editors:o});window.history.pushState({},"",a),t(2,s=a.toString()),navigator.clipboard.writeText(s).then(()=>{setTimeout(()=>{t(2,s="")},3e3)})}function p(a){B[a?"unshift":"push"](()=>{i.sandbox=a,t(1,i)})}function g(a){n=a,t(0,n)}function m(a){o=a,t(3,o)}return r.$$.update=()=>{r.$$.dirty&1&&u({type:"STYLE_CHANGE",value:n})},[n,i,s,o,l,_,p,g,m]}class De extends j{constructor(e){super();q(this,e,Be,Ae,W,{})}}export{De as default};
