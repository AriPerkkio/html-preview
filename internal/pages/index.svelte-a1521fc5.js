import{L as ce,S as B,i as $,s as q,e as w,t as R,c as I,a as T,h as S,d as h,g as k,J as E,M as L,K as F,k as A,m as M,b as O,N as Z,O as x,v as de,P as U,l as ee,w as W,x as J,y as G,Q as H,q as P,o as j,B as X,n as le,R as ue,p as fe,T as _e,U as Y,V as me,W as pe,j as he,X as ge,Y as be}from"../chunks/vendor-45d99f9f.js";import{_ as ve,b as te}from"../chunks/paths-fb6b994c.js";const ye=()=>{const r=ce("__svelte__");return{page:{subscribe:r.page.subscribe},navigating:{subscribe:r.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:r.navigating.subscribe}},session:r.session}},Ee={subscribe(r){return ye().page.subscribe(r)}};function oe(r){let e,n,s,i;return{c(){e=w("button"),n=R("Remove editor")},l(o){e=I(o,"BUTTON",{});var t=T(e);n=S(t,"Remove editor"),t.forEach(h)},m(o,t){k(o,e,t),E(e,n),s||(i=L(e,"click",r[3]),s=!0)},p:F,d(o){o&&h(e),s=!1,i()}}}function ke(r){let e,n,s,i=!r[1]&&oe(r);return{c(){i&&i.c(),e=A(),n=w("div"),s=w("textarea"),this.h()},l(o){i&&i.l(o),e=M(o),n=I(o,"DIV",{class:!0});var t=T(n);s=I(t,"TEXTAREA",{class:!0}),T(s).forEach(h),t.forEach(h),this.h()},h(){s.value=r[0],O(s,"class","svelte-1awo5ji"),O(n,"class","codemirror-container svelte-1awo5ji"),Z(n,"active",r[1])},m(o,t){i&&i.m(o,t),k(o,e,t),k(o,n,t),E(n,s),r[5](s)},p(o,[t]){o[1]?i&&(i.d(1),i=null):i?i.p(o,t):(i=oe(o),i.c(),i.m(e.parentNode,e)),t&1&&(s.value=o[0]),t&2&&Z(n,"active",o[1])},i:F,o:F,d(o){i&&i.d(o),o&&h(e),o&&h(n),r[5](null)}}}function we(r,e,n){const s=x();let{code:i=""}=e,{editorId:o}=e,{active:t=!1}=e,d;de(async()=>{let p=await ve(()=>import("../chunks/codemirror-f605f246.js"),["chunks/codemirror-f605f246.js","assets/codemirror-6f45da0e.css"]);await c(p.default)});async function c(p){if(!d)throw new Error("Missing ref to textarea");const y=p.fromTextArea(d,{lineNumbers:!0,lineWrapping:!0,mode:"htmlmixed",autoCloseBrackets:!0,autoCloseTags:!0,value:i});y.on("change",u=>{n(0,i=u.getValue()),s("change",{value:i,editorId:o})}),y.setValue(i)}function b(){s("remove",{editorId:o})}function m(p){U[p?"unshift":"push"](()=>{d=p,n(2,d)})}return r.$$set=p=>{"code"in p&&n(0,i=p.code),"editorId"in p&&n(4,o=p.editorId),"active"in p&&n(1,t=p.active)},r.$$.update=()=>{r.$$.dirty&19&&t&&s("change",{value:i,editorId:o})},[i,t,d,b,o,m]}class re extends B{constructor(e){super();$(this,e,we,ke,q,{code:0,editorId:4,active:1})}}function ne(r,e,n){const s=r.slice();return s[9]=e[n],s[10]=e,s[11]=n,s}function ie(r,e){let n,s,i,o;function t(c){e[6](c,e[9])}let d={active:e[9].id===e[1],editorId:e[9].id};return e[9].code!==void 0&&(d.code=e[9].code),s=new re({props:d}),U.push(()=>Y(s,"code",t)),s.$on("change",e[5]),s.$on("remove",e[3]),{key:r,first:null,c(){n=ee(),W(s.$$.fragment),this.h()},l(c){n=ee(),J(s.$$.fragment,c),this.h()},h(){this.first=n},m(c,b){k(c,n,b),G(s,c,b),o=!0},p(c,b){e=c;const m={};b&3&&(m.active=e[9].id===e[1]),b&1&&(m.editorId=e[9].id),!i&&b&1&&(i=!0,m.code=e[9].code,H(()=>i=!1)),s.$set(m)},i(c){o||(P(s.$$.fragment,c),o=!0)},o(c){j(s.$$.fragment,c),o=!1},d(c){c&&h(n),X(s,c)}}}function Ie(r){let e,n,s,i,o,t,d,c=[],b=new Map,m,p,y,u=r[0];const v=a=>a[9].id;for(let a=0;a<u.length;a+=1){let l=ne(r,u,a),_=v(l);b.set(_,c[a]=ie(_,l))}return{c(){e=w("button"),n=R("Next state"),s=A(),i=w("button"),o=R("Add editor"),t=A(),d=w("div");for(let a=0;a<c.length;a+=1)c[a].c()},l(a){e=I(a,"BUTTON",{});var l=T(e);n=S(l,"Next state"),l.forEach(h),s=M(a),i=I(a,"BUTTON",{});var _=T(i);o=S(_,"Add editor"),_.forEach(h),t=M(a),d=I(a,"DIV",{});var f=T(d);for(let V=0;V<c.length;V+=1)c[V].l(f);f.forEach(h)},m(a,l){k(a,e,l),E(e,n),k(a,s,l),k(a,i,l),E(i,o),k(a,t,l),k(a,d,l);for(let _=0;_<c.length;_+=1)c[_].m(d,null);m=!0,p||(y=[L(e,"click",r[4]),L(i,"click",r[2])],p=!0)},p(a,[l]){l&43&&(u=a[0],le(),c=ue(c,l,v,1,a,u,b,d,me,ie,null,ne),fe())},i(a){if(!m){for(let l=0;l<u.length;l+=1)P(c[l]);m=!0}},o(a){for(let l=0;l<c.length;l+=1)j(c[l]);m=!1},d(a){a&&h(e),a&&h(s),a&&h(i),a&&h(t),a&&h(d);for(let l=0;l<c.length;l+=1)c[l].d();p=!1,_e(y)}}}function Te(r,e,n){var y;let s;const i=x();let{editors:o=[{id:1,code:""}]}=e,t=((y=o[0])==null?void 0:y.id)||1;function d(){n(0,o=[...o,{id:1+s,code:""}])}function c(u){const{editorId:v}=u.detail;n(0,o=o.filter(a=>a.id!==v))}function b(){const u=o.map(a=>a.id);if(t===s){n(1,t=Math.min(...u));return}const v=u.indexOf(t);n(1,t=u[1+v])}function m(u){const{value:v,editorId:a}=u.detail;a===t&&i("change",{value:v})}function p(u,v){r.$$.not_equal(v.code,u)&&(v.code=u,n(0,o))}return r.$$set=u=>{"editors"in u&&n(0,o=u.editors)},r.$$.update=()=>{r.$$.dirty&1&&(s=Math.max(...o.map(u=>u.id)))},[o,t,d,c,b,m,p]}class Ne extends B{constructor(e){super();$(this,e,Te,Ie,q,{editors:0})}}function Ce(r){let e,n,s;function i(t){r[1](t)}let o={editorId:0};return r[0]!==void 0&&(o.code=r[0]),e=new re({props:o}),U.push(()=>Y(e,"code",i)),e.$on("change",r[2]),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,d){G(e,t,d),s=!0},p(t,[d]){const c={};!n&&d&1&&(n=!0,c.code=t[0],H(()=>n=!1)),e.$set(c)},i(t){s||(P(e.$$.fragment,t),s=!0)},o(t){j(e.$$.fragment,t),s=!1},d(t){X(e,t)}}}function Oe(r,e,n){let{code:s=""}=e;function i(t){s=t,n(0,s)}function o(t){pe.call(this,r,t)}return r.$$set=t=>{"code"in t&&n(0,s=t.code)},[s,i,o]}class Ae extends B{constructor(e){super();$(this,e,Oe,Ce,q,{code:0})}}function se(r){let e,n,s,i,o;return{c(){e=w("p"),n=R("TODO copy button here"),s=A(),i=w("a"),o=R(r[1]),this.h()},l(t){e=I(t,"P",{});var d=T(e);n=S(d,"TODO copy button here"),d.forEach(h),s=M(t),i=I(t,"A",{href:!0});var c=T(i);o=S(c,r[1]),c.forEach(h),this.h()},h(){O(i,"href",r[1])},m(t,d){k(t,e,d),E(e,n),k(t,s,d),k(t,i,d),E(i,o)},p(t,d){d&2&&he(o,t[1]),d&2&&O(i,"href",t[1])},d(t){t&&h(e),t&&h(s),t&&h(i)}}}function Me(r){let e,n,s,i,o,t,d,c,b,m,p,y,u,v,a,l,_,f=r[1]&&se(r);function V(g){r[8](g)}let K={};r[3]!==void 0&&(K.code=r[3]),m=new Ae({props:K}),U.push(()=>Y(m,"code",V)),m.$on("change",r[5]);function ae(g){r[9](g)}let Q={};return r[2]!==void 0&&(Q.editors=r[2]),u=new Ne({props:Q}),U.push(()=>Y(u,"editors",ae)),u.$on("change",r[4]),{c(){e=w("div"),n=w("iframe"),i=A(),o=w("div"),t=w("button"),d=R("Export"),c=A(),f&&f.c(),b=A(),W(m.$$.fragment),y=A(),W(u.$$.fragment),this.h()},l(g){e=I(g,"DIV",{class:!0});var C=T(e);n=I(C,"IFRAME",{security:!0,src:!0,title:!0}),T(n).forEach(h),i=M(C),o=I(C,"DIV",{});var N=T(o);t=I(N,"BUTTON",{class:!0});var D=T(t);d=S(D,"Export"),D.forEach(h),c=M(N),f&&f.l(N),b=M(N),J(m.$$.fragment,N),y=M(N),J(u.$$.fragment,N),N.forEach(h),C.forEach(h),this.h()},h(){O(n,"security","restricted"),ge(n.src,s=""+(te+"/sandbox"))||O(n,"src",s),O(n,"title","Sandbox"),O(t,"class","export-btn svelte-beehw1"),O(e,"class","wrapper svelte-beehw1")},m(g,C){k(g,e,C),E(e,n),r[7](n),E(e,i),E(e,o),E(o,t),E(t,d),E(o,c),f&&f.m(o,null),E(o,b),G(m,o,null),E(o,y),G(u,o,null),a=!0,l||(_=L(t,"click",r[6]),l=!0)},p(g,[C]){g[1]?f?f.p(g,C):(f=se(g),f.c(),f.m(o,b)):f&&(f.d(1),f=null);const N={};!p&&C&8&&(p=!0,N.code=g[3],H(()=>p=!1)),m.$set(N);const D={};!v&&C&4&&(v=!0,D.editors=g[2],H(()=>v=!1)),u.$set(D)},i(g){a||(P(m.$$.fragment,g),P(u.$$.fragment,g),a=!0)},o(g){j(m.$$.fragment,g),j(u.$$.fragment,g),a=!1},d(g){g&&h(e),r[7](null),f&&f.d(),X(m),X(u),l=!1,_()}}}function Re(r){return z(r,"id")&&typeof r.id=="number"&&z(r,"code")&&typeof r.code=="string"}function z(r,e){return r?e in r:!1}function Se(r,e,n){let s;be(r,Ee,a=>n(10,s=a));const i={};let o,{editors:t,style:d}=p();function c(a){var _,f;const{value:l}=a.detail;(f=(_=i.sandbox)==null?void 0:_.contentWindow)==null||f.postMessage({type:"CONTENT_CHANGE",value:l})}function b(a){var _,f;const{value:l}=a.detail;(f=(_=i.sandbox)==null?void 0:_.contentWindow)==null||f.postMessage({type:"STYLE_CHANGE",value:l})}function m(){const a=btoa(JSON.stringify({editors:t,style:d})),l=new URL(te,window.location.origin);l.searchParams.set("code",encodeURIComponent(a)),window.history.pushState({},"",l),n(1,o=l.toString())}function p(){const a={editors:[{id:1,code:""}],style:`<style>
  
</style>`},l=s.url.searchParams.get("code");let _;if(l)try{const f=atob(decodeURIComponent(l));_=JSON.parse(f)}catch(f){console.error("Unable to parse url search parameters",f)}return z(_,"style")&&typeof _.style=="string"&&z(_,"editors")&&Array.isArray(_.editors)&&_.editors.every(Re)?{style:_.style,editors:_.editors}:a}function y(a){U[a?"unshift":"push"](()=>{i.sandbox=a,n(0,i)})}function u(a){d=a,n(3,d)}function v(a){t=a,n(2,t)}return[i,o,t,d,c,b,m,y,u,v]}class De extends B{constructor(e){super();$(this,e,Se,Me,q,{})}}export{De as default};
