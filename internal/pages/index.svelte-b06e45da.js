import{S as B,i as j,s as U,e as y,t as q,c as k,a as I,h as W,d as p,g as T,J as E,L as J,K as F,k as M,m as O,b as C,M as Y,N as z,v as ne,O as R,l as Z,w as L,x as P,y as G,P as K,q as S,o as V,B as H,n as re,Q as ie,p as se,R as ae,T as Q,U as de,V as le,W as ce}from"../chunks/vendor-f9d32276.js";import{_ as ue,b as fe}from"../chunks/paths-fb6b994c.js";function x(i){let e,n,o,r;return{c(){e=y("button"),n=q("Remove editor")},l(t){e=k(t,"BUTTON",{});var a=I(e);n=W(a,"Remove editor"),a.forEach(p)},m(t,a){T(t,e,a),E(e,n),o||(r=J(e,"click",i[3]),o=!0)},p:F,d(t){t&&p(e),o=!1,r()}}}function _e(i){let e,n,o,r=!i[1]&&x(i);return{c(){r&&r.c(),e=M(),n=y("div"),o=y("textarea"),this.h()},l(t){r&&r.l(t),e=O(t),n=k(t,"DIV",{class:!0});var a=I(n);o=k(a,"TEXTAREA",{class:!0}),I(o).forEach(p),a.forEach(p),this.h()},h(){o.value=i[0],C(o,"class","svelte-1awo5ji"),C(n,"class","codemirror-container svelte-1awo5ji"),Y(n,"active",i[1])},m(t,a){r&&r.m(t,a),T(t,e,a),T(t,n,a),E(n,o),i[5](o)},p(t,[a]){t[1]?r&&(r.d(1),r=null):r?r.p(t,a):(r=x(t),r.c(),r.m(e.parentNode,e)),a&1&&(o.value=t[0]),a&2&&Y(n,"active",t[1])},i:F,o:F,d(t){r&&r.d(t),t&&p(e),t&&p(n),i[5](null)}}}function me(i,e,n){const o=z();let{code:r=""}=e,{editorId:t}=e,{active:a=!1}=e,m;ne(async()=>{let _=await ue(()=>import("../chunks/codemirror-f605f246.js"),["chunks/codemirror-f605f246.js","assets/codemirror-6f45da0e.css"]);await d(_.default)});async function d(_){if(!m)throw new Error("Missing ref to textarea");const l=_.fromTextArea(m,{lineNumbers:!0,lineWrapping:!0,mode:"htmlmixed",autoCloseBrackets:!0,autoCloseTags:!0,value:r});l.on("change",c=>{n(0,r=c.getValue()),o("change",{value:r,editorId:t})}),l.setValue(r)}function f(){o("remove",{editorId:t})}function g(_){R[_?"unshift":"push"](()=>{m=_,n(2,m)})}return i.$$set=_=>{"code"in _&&n(0,r=_.code),"editorId"in _&&n(4,t=_.editorId),"active"in _&&n(1,a=_.active)},i.$$.update=()=>{i.$$.dirty&19&&a&&o("change",{value:r,editorId:t})},[r,a,m,f,t,g]}class ee extends B{constructor(e){super();j(this,e,me,_e,U,{code:0,editorId:4,active:1})}}function te(i,e,n){const o=i.slice();return o[9]=e[n],o[10]=e,o[11]=n,o}function oe(i,e){let n,o,r,t;function a(d){e[6](d,e[9])}let m={active:e[9].id===e[1],editorId:e[9].id};return e[9].code!==void 0&&(m.code=e[9].code),o=new ee({props:m}),R.push(()=>Q(o,"code",a)),o.$on("change",e[5]),o.$on("remove",e[3]),{key:i,first:null,c(){n=Z(),L(o.$$.fragment),this.h()},l(d){n=Z(),P(o.$$.fragment,d),this.h()},h(){this.first=n},m(d,f){T(d,n,f),G(o,d,f),t=!0},p(d,f){e=d;const g={};f&3&&(g.active=e[9].id===e[1]),f&1&&(g.editorId=e[9].id),!r&&f&1&&(r=!0,g.code=e[9].code,K(()=>r=!1)),o.$set(g)},i(d){t||(S(o.$$.fragment,d),t=!0)},o(d){V(o.$$.fragment,d),t=!1},d(d){d&&p(n),H(o,d)}}}function he(i){let e,n,o,r,t,a,m,d=[],f=new Map,g,_,l,c=i[0];const h=s=>s[9].id;for(let s=0;s<c.length;s+=1){let u=te(i,c,s),b=h(u);f.set(b,d[s]=oe(b,u))}return{c(){e=y("button"),n=q("Next state"),o=M(),r=y("button"),t=q("Add editor"),a=M(),m=y("div");for(let s=0;s<d.length;s+=1)d[s].c()},l(s){e=k(s,"BUTTON",{});var u=I(e);n=W(u,"Next state"),u.forEach(p),o=O(s),r=k(s,"BUTTON",{});var b=I(r);t=W(b,"Add editor"),b.forEach(p),a=O(s),m=k(s,"DIV",{});var $=I(m);for(let A=0;A<d.length;A+=1)d[A].l($);$.forEach(p)},m(s,u){T(s,e,u),E(e,n),T(s,o,u),T(s,r,u),E(r,t),T(s,a,u),T(s,m,u);for(let b=0;b<d.length;b+=1)d[b].m(m,null);g=!0,_||(l=[J(e,"click",i[4]),J(r,"click",i[2])],_=!0)},p(s,[u]){u&43&&(c=s[0],re(),d=ie(d,u,h,1,s,c,f,m,de,oe,null,te),se())},i(s){if(!g){for(let u=0;u<c.length;u+=1)S(d[u]);g=!0}},o(s){for(let u=0;u<d.length;u+=1)V(d[u]);g=!1},d(s){s&&p(e),s&&p(o),s&&p(r),s&&p(a),s&&p(m);for(let u=0;u<d.length;u+=1)d[u].d();_=!1,ae(l)}}}function pe(i,e,n){var l;let o;const r=z();let{editors:t=[{id:1,code:""}]}=e,a=((l=t[0])==null?void 0:l.id)||1;function m(){n(0,t=[...t,{id:1+o,code:""}])}function d(c){const{editorId:h}=c.detail;n(0,t=t.filter(s=>s.id!==h))}function f(){const c=t.map(s=>s.id);if(a===o){n(1,a=Math.min(...c));return}const h=c.indexOf(a);n(1,a=c[1+h])}function g(c){const{value:h,editorId:s}=c.detail;s===a&&r("change",{value:h})}function _(c,h){i.$$.not_equal(h.code,c)&&(h.code=c,n(0,t))}return i.$$set=c=>{"editors"in c&&n(0,t=c.editors)},i.$$.update=()=>{i.$$.dirty&1&&(o=Math.max(...t.map(c=>c.id)))},[t,a,m,d,f,g,_]}class ge extends B{constructor(e){super();j(this,e,pe,he,U,{editors:0})}}function ve(i){let e,n;return e=new ee({props:{code:i[0],editorId:0}}),e.$on("change",i[1]),{c(){L(e.$$.fragment)},l(o){P(e.$$.fragment,o)},m(o,r){G(e,o,r),n=!0},p(o,[r]){const t={};r&1&&(t.code=o[0]),e.$set(t)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){V(e.$$.fragment,o),n=!1},d(o){H(e,o)}}}function be(i,e,n){let{code:o=""}=e;function r(t){le.call(this,i,t)}return i.$$set=t=>{"code"in t&&n(0,o=t.code)},[o,r]}class Ee extends B{constructor(e){super();j(this,e,be,ve,U,{code:0})}}function ye(i){let e,n,o,r,t,a,m,d,f,g,_,l,c,h,s,u;function b(v){i[7](v)}let $={};i[2]!==void 0&&($.code=i[2]),f=new Ee({props:$}),R.push(()=>Q(f,"code",b)),f.$on("change",i[4]);function A(v){i[8](v)}let X={};return i[1]!==void 0&&(X.editors=i[1]),l=new ge({props:X}),R.push(()=>Q(l,"editors",A)),l.$on("change",i[3]),{c(){e=y("div"),n=y("iframe"),r=M(),t=y("div"),a=y("button"),m=q("Export"),d=M(),L(f.$$.fragment),_=M(),L(l.$$.fragment),this.h()},l(v){e=k(v,"DIV",{class:!0});var w=I(e);n=k(w,"IFRAME",{security:!0,src:!0,title:!0}),I(n).forEach(p),r=O(w),t=k(w,"DIV",{});var N=I(t);a=k(N,"BUTTON",{class:!0});var D=I(a);m=W(D,"Export"),D.forEach(p),d=O(N),P(f.$$.fragment,N),_=O(N),P(l.$$.fragment,N),N.forEach(p),w.forEach(p),this.h()},h(){C(n,"security","restricted"),ce(n.src,o=""+(fe+"/sandbox"))||C(n,"src",o),C(n,"title","Sandbox"),C(a,"class","export-btn svelte-beehw1"),C(e,"class","wrapper svelte-beehw1")},m(v,w){T(v,e,w),E(e,n),i[6](n),E(e,r),E(e,t),E(t,a),E(a,m),E(t,d),G(f,t,null),E(t,_),G(l,t,null),h=!0,s||(u=J(a,"click",i[5]),s=!0)},p(v,[w]){const N={};!g&&w&4&&(g=!0,N.code=v[2],K(()=>g=!1)),f.$set(N);const D={};!c&&w&2&&(c=!0,D.editors=v[1],K(()=>c=!1)),l.$set(D)},i(v){h||(S(f.$$.fragment,v),S(l.$$.fragment,v),h=!0)},o(v){V(f.$$.fragment,v),V(l.$$.fragment,v),h=!1},d(v){v&&p(e),i[6](null),H(f),H(l),s=!1,u()}}}function ke(i,e,n){const o={};let r=[{id:1,code:""}],t=`<style>
  
</style>`;function a(l){var h,s;const{value:c}=l.detail;(s=(h=o.sandbox)==null?void 0:h.contentWindow)==null||s.postMessage({type:"CONTENT_CHANGE",value:c})}function m(l){var h,s;const{value:c}=l.detail;(s=(h=o.sandbox)==null?void 0:h.contentWindow)==null||s.postMessage({type:"STYLE_CHANGE",value:c})}function d(){const l=btoa(JSON.stringify({editors:r,style:t}));alert(`TODO: Copy to clipboard and display: <url>?code=${l}`),console.log("Decoded",JSON.parse(atob(l)))}function f(l){R[l?"unshift":"push"](()=>{o.sandbox=l,n(0,o)})}function g(l){t=l,n(2,t)}function _(l){r=l,n(1,r)}return[o,r,t,a,m,d,f,g,_]}class we extends B{constructor(e){super();j(this,e,ke,ye,U,{})}}export{we as default};
